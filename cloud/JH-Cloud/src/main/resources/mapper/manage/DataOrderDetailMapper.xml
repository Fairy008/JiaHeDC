<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.jh.manage.order.mapping.IDataOrderDetailMapper" >
  <resultMap id="BaseResultMap" type="com.jh.manage.order.entity.DataOrderDetail" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="order_detail_id" property="orderDetailId" jdbcType="INTEGER" />
    <result column="order_id" property="orderId" jdbcType="INTEGER" />
    <result column="storage_id" property="storageId" jdbcType="INTEGER" />
    <result column="file_name" property="fileName" jdbcType="VARCHAR" />
    <result column="file_size" property="fileSize" jdbcType="VARCHAR" />
    <result column="data_path" property="dataPath" jdbcType="VARCHAR"/>
  </resultMap>

  <sql id="Base_Column_List" >
    order_detail_id, order_id, storage_id,file_name,file_size
  </sql>


  <!--
   * 删除订单详情：根据订单主键删除订单详情
   * @param orderId 订单ID
   * @return
   * @version <1> 2018-03-13 cxw： Created.
   *-->
  <update id="delOrderDetailByOrderId" parameterType="java.lang.Integer" >
    UPDATE man_order_detail set del_flag = '1'
    where order_id = #{orderId,jdbcType=INTEGER}
  </update>


  <insert id="insertDataOrderDetail" parameterType="DataOrderDetail" >
    insert into man_order_detail
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="orderId != null" >
        order_id,
      </if>
      <if test="storageId != null" >
        storage_id,
      </if>
      <if test="fileName != null">
        file_name,
      </if>
      <if test="fileSize != null">
        file_size,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="orderId != null" >
        #{orderId,jdbcType=INTEGER},
      </if>
      <if test="storageId != null" >
        #{storageId,jdbcType=INTEGER},
      </if>
      <if test="fileName != null">
        #{fileName,jdbcType=VARCHAR},
      </if>
      <if test="fileSize != null" >
        #{fileSize,jdbcType=VARCHAR},
      </if>

    </trim>
  </insert>


  <!--根据订单ID查询订单明细-->
  <!--<select id="findOrderListByOrderId" parameterType="Integer" resultMap="BaseResultMap">-->
    <!--select <include refid="Base_Column_List" /> from man_order_detail-->
    <!--where order_id = #{orderId,jdbcType=INTEGER}-->
  <!--</select>-->

  <select id="findOrderDetailById" parameterType="Integer" resultMap="BaseResultMap">

    select <include refid="Base_Column_List" /> from man_order_detail where order_detail_id = #{orderDetailId,jdbcType=INTEGER}

  </select>

  <!--根据订单ID查询订单明细-->
  <select id="findOrderListByOrderId" parameterType="Integer" resultMap="BaseResultMap">
        SELECT
        a.order_detail_id,
        a.order_id,
        a.storage_id,
        a.file_name,
        a.file_size,
        b.data_path
    FROM
        man_order_detail a
        LEFT JOIN man_order_task b ON a.order_id = b.order_id
    WHERE
        a.order_id = #{orderId,jdbcType=INTEGER}
  </select>



</mapper>
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <link type="text/css" rel="stylesheet" href="css/base.css"/>
    <!-- <link rel="stylesheet" type="text/css" href="css/index/index.css" > -->
    <style>
        /*.rightTop{ border-bottom: 1px solid #f0f0f0; padding:0 20px;}*/
        /*.rightTop .box{ width: 1300px; margin:0 auto; height: 62px; }*/

        .content{ width: 984px; margin:27px auto; overflow: auto;}
        /*左侧轮播*/
        .content .conMain{ width: 672px; float: left; }
        /*左侧列表**/
        .list{ width: 672px; margin-top: 27px;}
        .list h1{ border-bottom: 1px solid #cccccc; padding:0 6px; padding-bottom: 18px;}
        .list h1 a{ color:#000; font-size: 16px; margin-right: 27px; padding-bottom: 14px; }
        .list h1 a.on{ font-weight: bold; border-bottom: 3px solid #000;}
        .list h1 a:hover{ cursor: pointer;}
        .list h2{ font-size: 18px; font-weight: bold; line-height: 22px; color: #000;}
        .list dl dd p{ font-size: 14px; color: #7b7b7b; line-height: 27px;}
        .list span.lab:first-of-type{margin-left:8px;}
        .list i.hot{ vertical-align: text-top; margin-right: 3px;}
        .list dl{ border-bottom: 1px solid #f0f0f0; padding:14px 5px;}
        .list dl dt.report{ float: right; margin-top:10px;}
        .list dl dt.report img{ width: 147px; height: 98px; border-radius: 3px; margin-left: 18px;}
        .list dl dd p.brief{ height: 54px; margin-top:16.5px;}
        .list dl dd p.info{ color: #9cbfcb; font-size: 12px;}
        .list dl dd p.info b{ font-weight: bold; margin-right: 4px;}
        .list dl dd p.info i.time{ margin-right: 24px;}
        .list dl dd p.info span{ background: url("images/public/forum/comment.png") 0px 0px no-repeat; padding-left:20px;}
        .list dl dd p.info span.comment{ background-position: 0px 0px; margin-right: 14px;}
        .list dl dd p.info span.collect{ background-position: 0px -49px;}
        .loadMore{ height: 38px; line-height: 38px; font-size: 12px; color: #000; border:1px solid #e2e2e2; border-radius: 5px; text-align: center; margin-top:40px;}
        .loadMore:hover{ cursor: pointer;}
        /*右侧 侧边栏*/
        .content .sidebar{ width: 290px; float: right; }
        .sidebar .loadApp{ height: 83px; width: 100%; padding:10px; box-sizing: border-box; border:1px solid #f0f0f0; border-radius: 5px;}
        .sidebar .loadApp img{ float: left; margin-right: 22px;}
        .sidebar .loadApp h2{font-size:18px; color:#242b33; margin-top:10px;}
        .sidebar .loadApp p{font-size:14px; color:#9a9a9a; margin-top:14px;}
        .sidebar .enterBtn{ height: 83px; margin-top:15px; border:1px solid #f0f0f0; border-radius: 5px;}
        .sidebar .enterBtn ul{ height: 83px; width: 100%; padding: 0 12px; box-sizing: border-box;}
        .sidebar .enterBtn ul li{  height: 100%; width: 100%;height: 60px}
        /*.sidebar .enterBtn ul li a{ line-height: 115px; font-size: 16px; color: #000; width: 100%; height: 100%; display: inline-block; text-align: center; background: url("images/public/forum/moudle_icon.png") 0px 0px no-repeat;}*/
        .sidebar .enterBtn ul li a{ line-height: 115px; font-size: 16px; color: #000; width: 100%; height: 100%; display: inline-block; text-align: center}
        .sidebar .enterBtn ul li a:hover{ cursor: pointer;}
        .sidebar .enterBtn ul li.writeReport a{ background-position: 32px 21px;}
        .sidebar .enterBtn ul li.writeReport a{background: url(./img/WrightRP.png) no-repeat right};
        .sidebar .enterBtn ul li.survey a{background-position:31px -43px;background: url("img/makeSurvey.png") no-repeat right; }
        .sidebar .enterBtn ul li.ask a{background-position: 29px -108px;background: url("./img/ASK.png") no-repeat right}
        /*热门标签*/
        .hotTag{ margin-top:27px; position: relative; padding-bottom: 20px;}
        .hotTag h2{ font-size: 16px; color: #040000; font-weight: bold; }
        .hotTag p.tags{ margin-top:16px; padding-left:2px; height: 150px; overflow: hidden;}
        .hotTag p.tags a{ display: inline-block; margin:0 3.5px; margin-bottom:8px;border:1px solid #dfdcdc; height: 23px; line-height: 23px; border-radius: 5px; padding:0 8px; font-size: 12px; color: #3b3b3b;}
        .hotTag p.lookMore{ text-align: center; height: 45px; line-height: 76px; width: 100%; position: absolute; bottom: 0;
            background: -moz-linear-gradient(top, rgba(255,255,255,0.2) 0%, rgba(255,255,255,1) 100%) ;
            background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(255,255,255,0.2)), color-stop(100%,rgba(255,255,255,1)))  ;
            background: -webkit-linear-gradient(top, rgba(255,255,255,0.2) 0%,rgba(255,255,255,1) 100%) ;
            background: -o-linear-gradient(top, rgba(255,255,255,0.2) 0%,rgba(255,255,255,1) 100%) ;
            background: -ms-linear-gradient(top, rgba(255,255,255,0.2) 0%,rgba(255,255,255,1) 100%) ;}
        .hotTag p.lookMore a{ color: #028ec9; font-size: 12px;}
        .hotTag p.lookMore a:hover{cursor: pointer;}
        /*热门报告*/
        .hotList{ margin-top:30px;}
        .hotList dl{ margin-bottom: 24px;}
        .hotList dl dt{ border-bottom: 1px solid #e9e9e9;}
        .hotList dl dt h2{ height: 30px; line-height: 30px; font-weight: bold;}
        .hotList dl dt .changeIco:hover{ cursor: pointer;}
        .hotList dl dt .changeIco{float: right; font-weight: normal; font-size: 12px; color: #969696; padding-left:17px; background: url("images/public/forum/change.png") left center no-repeat;}
        .hotList dl dt a.more{ float: right; font-size: 12px; color: #2997cd;}
        .hotList dl dt a.more:hover{ cursor: pointer;}
        .hotList ul li{ padding:14px 0; border-bottom: 1px solid #e9e9e9; overflow: auto;}
        .hotList ul li p.info{ color: #9cbfcb; font-size: 12px; margin-top:14px;}
        .hotList ul li p.info b{ font-weight: bold; margin-right: 4px;}
        .hotList ul li p.info i.time{ margin-right: 24px;}
        .hotList ul li .addBtn{ float: right; height: 18px; line-height: 18px; margin-top:10px; padding:0 7px; display: inline-block; border:1px solid #00a4da; color: #00a4da; border-radius: 5px; font-size: 12px;}
        .hotList ul li .addBtn:hover{ cursor: pointer;}
        .hotList ul li h3{ font-size: 14px; color: #040000; width: 230px;overflow: hidden; text-overflow: ellipsis; white-space:nowrap;}
        /*专家列表*/
        .hotList ul.expertList li a:hover{ cursor: pointer;}
        .hotList ul.expertList li a img{ float: left; width: 45px; height: 45px; border-radius: 50%;}
        .hotList ul.expertList li .peoInfo{ float: left; width: 180px; margin-left:7px; margin-top:4px;}
        .hotList ul.expertList li .peoInfo h3{ font-size: 14px; color: #040000;}
        .hotList ul.expertList li .peoInfo p{ margin-top:10px; font-size: 12px; color: #7b7b7b;}
        /*回到顶部*/
        .returnTop{ position: fixed; bottom: 30px; left:50%; width: 38px; height: 38px; background: #F5A836 url("images/public/forum/returnTop.png") center center no-repeat; border:1px solid #e2e2e2; border-radius: 5px;}
        .returnTop:hover{ cursor: pointer;}
    </style>
    <title>提问</title>

</head>
<body>

<div style="height:100%;">

    <div class="content">

        <div>标题：<input type="text" class="input" id="title" /></div>
        <script id="editor" type="text/plain" style="width:1024px;height:400px;">时间：</br>地点：</br>调研事项:</br>注意事项</br></script>
        <div>文章标签：
        <table>
        <tbody id="paramsList">
            <tr class="paramsTr">
            <td id="firstTd"><img src="images/public/addrow.png"  id="addTd" style='margin-top: 2px;'>新增标签</td>
            </tr>
            </tbody>
            </table>

            </div>
            <div>
            <button id="addReport">保存</button>

            </div>
            </div>
            <!--个人中心菜单内容显示-->
            <div id="menuInfo" style="display:none;"></div>
            </div>
            <!--右边结束-->
            <script type="text/javascript" charset="utf-8" src="js/ueditor/ueditor.config.js"></script>
        <script type="text/javascript" charset="utf-8" src="js/ueditor/ueditor.all.js"></script>
        <script type="text/javascript" charset="utf-8" src="js/ueditor/third-party/zeroclipboard/ZeroClipboard.js"></script>
        <script type="text/javascript" src="js/lib/require/require.js"></script>
        <script type="text/javascript" src="js/url_config.js"></script>
        <script type="text/javascript" src="js/config.js"></script>
        <script type="text/javascript">


            require(["jquery","Marquee","BaseAjax","UserModule","commons","urlConfig"],function($,Marquee,BaseAjax,UserModule,commons,urlConfig){
                var token = commons.getAccessToken();
                var ue = UE.getEditor('editor',{"serverUrl":FORUM_COMMENT.upFile+"?AccessToken=" + token});


                $("#addReport").click(function() {
                    addSaveFun();
                });

                var init = function(){
                    //查看更多标签
                    lookMore();
                    //tab切换
                    tabFun();
                    //绑定增加行事件
                    $("#addTd").bind("click",addLabel);
                }
                // //一次滚动一屏
                // $('#marquee3').kxbdSuperMarquee({
                //     distance:620,
                //     time:4,
                //     navId:'#mar3Nav',
                //     direction:'left'
                // });

                var lookMore = function(){
                    $('.lookMore a').on('click',function(){
                        $('.tags').css('height','auto');
                        $('.lookMore').hide();
                    });
                };

                var tabFun = function(){
                    $('.list h1 a').on('click',function(){
                        $(this).addClass('on').siblings('a').removeClass('on');
                    });
                };

                var addSaveFun =function(){
                    var article = {};
                    article.articleTitle = $("#title").val();;
                    article.articleType = 11001;
                    article.articleStatus = 12001;
                    article.articleContent = UE.getEditor('editor').getAllHtml();
                    <!--获取标签开始-->
                    var articleLabelArr = [];
                    var articleLabel= "";
                    $("#paramsList").find("tr").children().each(function(){
                        var labelContent = $(this).find("input").val();
                        if(labelContent!=undefined && labelContent!=""){
                            articleLabelArr.push($(this).find("input").val());
                        }
                    });
                    for(var i=0;i<articleLabelArr.length;i++){
                        if(i!=articleLabelArr.length-1){
                            articleLabel += articleLabelArr[i] +",";
                        }else{//最后一个不加"，"
                            articleLabel += articleLabelArr[i];
                        }
                    };
                    <!--获取标签结束-->


                    article.articleLabel = articleLabel;

                    //获取当前登录人token
                    var token = commons.getAccessToken()




                    var checkAjax = new BaseAjax();
                    checkAjax.opts.url = FORUM_ARTICLE.addArticle_url;
                    checkAjax.opts.async = false; //同步
                    checkAjax.opts.data = JSON.stringify(article);
                    checkAjax.opts.successFun = function(result){
                        if(result.flag){
                            PopWin.showMessageWin("新增成功");
                        }else{
                            PopWin.showMessageWin("新增失败");
                        }
                    }

                    checkAjax.run();
                };


                var addLabel=function(){
                    var len=6;//控制最多显示几个
                    var labelTr = $('#firstTd');
                    var newtd = $("<td ><input type='text'  name='articleLabel' class='inputType'  /><img src='images/public/reduce.png' class='removeTd' style='margin-top: 2px;' ></td>");

                    labelTr.before(newtd);

                    //判断 如果已经有三行 则增加按钮置灰
                    if($(".paramsTr").find("td").size()==len){//这里获取每一行有多少个标签只能以$(".paramsTr").find("td").size()的方式，不能在前面以变量的方式定义，否则会出现清空所有标签后再添加会一次添加好几个的情况
                        //增加按钮置灰 并移除增加行事件
                        $("#firstTd").find("img").unbind("click",addLabel);
                        $("#firstTd").find("img").attr("src","images/public/addGRAY.png");
                    }

                    $(".removeTd").click(function() {//点击动态移除一行
                        //判断 如果当前为5行 则增加按钮置蓝色 并移除一行
                        if($(".paramsTr").find("td").size()==len){//这里获取每一行有多少个标签只能以$(".paramsTr").find("td").size()的方式，不能在前面以变量的方式定义，否则会出现清空所有标签后再添加会一次添加好几个的情况
                            //增加按钮变蓝 并绑定增加行事件
                            $("#firstTd").find("img").bind("click",addLabel);
                            $("#firstTd").find("img").attr("src","images/public/addrow.png");
                        }
                        $(this).parent().remove();
                    });
                }
                // commons.initSystem();

                init();
            })
        </script>
</body>
</html>
